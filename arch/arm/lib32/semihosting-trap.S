/* SPDX-License-Identifier: GPL-2.0-only */
/* SPDX-FileCopyrightText: 2015 Zodiac Inflight Innovations */

/*
 * semihosting-trap.S -- Assembly code needed to make a semihosting call
 *
 * Author: Andrey Smirnov <andrew.smirnov@gmail.com>
 */

#include <linux/linkage.h>
#include <asm/unified.h>

.section .text.semihosting_trap
ENTRY(semihosting_trap)
	@ In supervisor mode SVC would clobber LR
	push	{lr}
	ARM(	svc	#0x123456	)
#ifdef CONFIG_ARCH_V7M /* Not valid for Cortex-M4 */
	THUMB(	bkpt	#0xAB		)
#else
	THUMB(	svc	#0xAB		)
#endif
	pop	{pc}
ENDPROC(semihosting_trap)
